# Python-for-Accounting-Auditing
## 研一下课程Python for Accounting&amp;Auditing期末大作业展示
### 小组成员：
陈蕴琦 2020213431

董秋灼 2020213432

吴倩   2020213451

夏安琪 2020213452

许思怡 2020213453

严璐安 2020213454
### 分工情况：
爬虫、分词、训练分类器并打分、上证指数吧股评文本情感分析：陈蕴琦 董秋灼

训练分类器并打分、贵州茅台吧股评文本情感分析：许思怡 严璐安

训练分类器并打分、上台展示：吴倩 夏安琪

Github端的工作：董秋灼

### 文件夹“上证指数吧——股评文本情感分析”爬取了40W+条股吧——上证指数吧的股评文本数据，并通过分析这些股评文本积极、消极情况，计算每天的情绪指数（BI_index），并和上证指数的走势做对比
#### 文件夹data内容介绍：
negative.txt：用作训练集的消极文本语料，Github上的前辈提供

positive.txt：用作训练集的积极文本语料，Github上的前辈提供

股吧评论爬取.ipynb：对上证指数吧的发帖标题、发帖时间进行爬取（下午1点-4点之间爬取，不容易被封IP，其他时间段爬取100页数据后，IP地址会被股吧封禁，大概半小时后解封）

comments.xlsx：爬取的原始股评文本数据

jieba_cut.ipynb：给时间加上年份；对评论进行分词

sh000001.CSV：爬取的评论所处的这段时间里，上证指数的走势数据

sh000001.xlsx：也是爬取的评论所处的这段时间里，上证指数的走势数据

stock_comments_seg.csv：分好词的股评文本数据

#### 文件夹中其他内容介绍：
csv文件打开方式选择记事本，否则会出现乱码

代码执行顺序：model_ml.ipynb（机器学习） → compute_sent_idx.ipynb（情绪指数） → plot_sent_idx.ipynb（作图）

model_ml.ipynb：机器学习，用训练集测试了八个分类器算法，最后选择了综合得分最高的LinearSVC算法，对我们爬取的股评文本进行分析

compute_sent_idx.ipynb：把同一天发布的评论分为一组，分析每组中消极语料、积极语料的占比情况，消极语料为0，积极语料为1，计算每天的情绪指数（BI_index）

plot_sent_idx.ipynb：作图

plot.png：画出的图

文件夹中的其他csv文件都是在代码执行中生成的

### 文件夹“贵州茅台吧——股评文本情感分析”所做工作与前面所述差不多，因为贵州茅台吧每天的股评数量小于上证指数吧，所以对贵州茅台吧可以爬取一个更长时间跨度的数据；同时也可以对比大盘与个股做出来的效果差距


